import{_ as l,r as c,o as r,c as o,a as e,e as s,w as i,b as n,d}from"./app-a153c100.js";const p="/MyBlog/assets/image-20210418154704436-ac680f90.png",u="/MyBlog/assets/image-20210417133020614-2d065126.png",m={},v=e("h1",{id:"centos7-å®‰è£…-docker-ğŸ§™",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#centos7-å®‰è£…-docker-ğŸ§™","aria-hidden":"true"},"#"),n(" Centos7 å®‰è£… Docker ğŸ§™")],-1),k={class:"table-of-contents"},b=e("p",null,"Docker åˆ†ä¸º CE å’Œ EE ä¸¤å¤§ç‰ˆæœ¬ã€‚CE å³ç¤¾åŒºç‰ˆï¼ˆå…è´¹ï¼Œæ”¯æŒå‘¨æœŸ 7 ä¸ªæœˆï¼‰ï¼ŒEE å³ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä»˜è´¹ä½¿ç”¨ï¼Œæ”¯æŒå‘¨æœŸ 24 ä¸ªæœˆã€‚",-1),h=e("p",null,[n("Docker CE åˆ†ä¸º "),e("code",null,"stable"),n(),e("code",null,"test"),n(" å’Œ "),e("code",null,"nightly"),n(" ä¸‰ä¸ªæ›´æ–°é¢‘é“ã€‚")],-1),g={href:"https://docs.docker.com/install/",target:"_blank",rel:"noopener noreferrer"},_=d(`<h1 id="_1-centos-å®‰è£…-docker" tabindex="-1"><a class="header-anchor" href="#_1-centos-å®‰è£…-docker" aria-hidden="true">#</a> 1.CentOS å®‰è£… Docker</h1><p>Docker CE æ”¯æŒ 64 ä½ç‰ˆæœ¬ CentOS 7ï¼Œå¹¶ä¸”è¦æ±‚å†…æ ¸ç‰ˆæœ¬ä¸ä½äº 3.10ï¼Œ CentOS 7 æ»¡è¶³æœ€ä½å†…æ ¸çš„è¦æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ CentOS 7 å®‰è£… Dockerã€‚</p><h2 id="_1-1-å¸è½½-å¯é€‰" tabindex="-1"><a class="header-anchor" href="#_1-1-å¸è½½-å¯é€‰" aria-hidden="true">#</a> 1.1.å¸è½½ï¼ˆå¯é€‰ï¼‰</h2><p>å¦‚æœä¹‹å‰å®‰è£…è¿‡æ—§ç‰ˆæœ¬çš„ Dockerï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤å¸è½½ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>yum remove docker \\
                  docker-client \\
                  docker-client-latest \\
                  docker-common \\
                  docker-latest \\
                  docker-latest-logrotate \\
                  docker-logrotate \\
                  docker-selinux \\
                  docker-engine-selinux \\
                  docker-engine \\
                  docker-ce
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-2-å®‰è£…-docker" tabindex="-1"><a class="header-anchor" href="#_1-2-å®‰è£…-docker" aria-hidden="true">#</a> 1.2.å®‰è£… docker</h2><p>é¦–å…ˆéœ€è¦å¤§å®¶è™šæ‹Ÿæœºè”ç½‘ï¼Œå®‰è£… yum å·¥å…·</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> yum-utils <span class="token punctuation">\\</span>
           device-mapper-persistent-data <span class="token punctuation">\\</span>
           lvm2 --skip-broken
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åæ›´æ–°æœ¬åœ°é•œåƒæºï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># è®¾ç½®dockeré•œåƒæº</span>
yum-config-manager <span class="token punctuation">\\</span>
    --add-repo <span class="token punctuation">\\</span>
    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo

<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/download.docker.com/mirrors.aliyun.com\\/docker-ce/g&#39;</span> /etc/yum.repos.d/docker-ce.repo

yum makecache fast
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åè¾“å…¥å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> docker-ce
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>docker-ce ä¸ºç¤¾åŒºå…è´¹ç‰ˆæœ¬ã€‚ç¨ç­‰ç‰‡åˆ»ï¼Œdocker å³å¯å®‰è£…æˆåŠŸã€‚</p><h2 id="_1-3-å¯åŠ¨-docker" tabindex="-1"><a class="header-anchor" href="#_1-3-å¯åŠ¨-docker" aria-hidden="true">#</a> 1.3.å¯åŠ¨ docker</h2><p>Docker åº”ç”¨éœ€è¦ç”¨åˆ°å„ç§ç«¯å£ï¼Œé€ä¸€å»ä¿®æ”¹é˜²ç«å¢™è®¾ç½®ã€‚éå¸¸éº»çƒ¦ï¼Œå› æ­¤å»ºè®®å¤§å®¶ç›´æ¥å…³é—­é˜²ç«å¢™ï¼</p><p>å¯åŠ¨ docker å‰ï¼Œä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼ï¼</p><p>å¯åŠ¨ docker å‰ï¼Œä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼ï¼</p><p>å¯åŠ¨ docker å‰ï¼Œä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼ï¼</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å…³é—­</span>
systemctl stop firewalld
<span class="token comment"># ç¦æ­¢å¼€æœºå¯åŠ¨é˜²ç«å¢™</span>
systemctl disable firewalld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡å‘½ä»¤å¯åŠ¨ dockerï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl start <span class="token function">docker</span>  <span class="token comment"># å¯åŠ¨dockeræœåŠ¡</span>

systemctl stop <span class="token function">docker</span>  <span class="token comment"># åœæ­¢dockeræœåŠ¡</span>

systemctl restart <span class="token function">docker</span>  <span class="token comment"># é‡å¯dockeræœåŠ¡</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åè¾“å…¥å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹ docker ç‰ˆæœ¬ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker -v
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚å›¾ï¼š</p><p><img src="`+p+'" alt="image-20210418154704436"></p><h2 id="_1-4-é…ç½®é•œåƒåŠ é€Ÿ" tabindex="-1"><a class="header-anchor" href="#_1-4-é…ç½®é•œåƒåŠ é€Ÿ" aria-hidden="true">#</a> 1.4.é…ç½®é•œåƒåŠ é€Ÿ</h2><p>docker å®˜æ–¹é•œåƒä»“åº“ç½‘é€Ÿè¾ƒå·®ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®å›½å†…é•œåƒæœåŠ¡ï¼š</p><p>å‚è€ƒé˜¿é‡Œäº‘çš„é•œåƒåŠ é€Ÿæ–‡æ¡£ï¼šhttps://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</p><h1 id="_2-centos7-å®‰è£…-dockercompose" tabindex="-1"><a class="header-anchor" href="#_2-centos7-å®‰è£…-dockercompose" aria-hidden="true">#</a> 2.CentOS7 å®‰è£… DockerCompose</h1><h2 id="_2-1-ä¸‹è½½" tabindex="-1"><a class="header-anchor" href="#_2-1-ä¸‹è½½" aria-hidden="true">#</a> 2.1.ä¸‹è½½</h2><p>Linux ä¸‹éœ€è¦é€šè¿‡å‘½ä»¤ä¸‹è½½ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å®‰è£…</span>\n<span class="token function">curl</span> <span class="token parameter variable">-L</span> https://github.com/docker/compose/releases/download/1.23.1/docker-compose-<span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> <span class="token parameter variable">-s</span><span class="token variable">`</span></span>-<span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> <span class="token parameter variable">-m</span><span class="token variable">`</span></span> <span class="token operator">&gt;</span> /usr/local/bin/docker-compose\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä¸‹è½½é€Ÿåº¦è¾ƒæ…¢ï¼Œæˆ–è€…ä¸‹è½½å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨è¯¾å‰èµ„æ–™æä¾›çš„ docker-compose æ–‡ä»¶ï¼š</p><p><img src="'+u+`" alt="image-20210417133020614"></p><p>ä¸Šä¼ åˆ°<code>/usr/local/bin/</code>ç›®å½•ä¹Ÿå¯ä»¥ã€‚</p><h2 id="_2-2-ä¿®æ”¹æ–‡ä»¶æƒé™" tabindex="-1"><a class="header-anchor" href="#_2-2-ä¿®æ”¹æ–‡ä»¶æƒé™" aria-hidden="true">#</a> 2.2.ä¿®æ”¹æ–‡ä»¶æƒé™</h2><p>ä¿®æ”¹æ–‡ä»¶æƒé™ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ä¿®æ”¹æƒé™</span>
<span class="token function">chmod</span> +x /usr/local/bin/docker-compose
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-3-base-è‡ªåŠ¨è¡¥å…¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_2-3-base-è‡ªåŠ¨è¡¥å…¨å‘½ä»¤" aria-hidden="true">#</a> 2.3.Base è‡ªåŠ¨è¡¥å…¨å‘½ä»¤ï¼š</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># è¡¥å…¨å‘½ä»¤</span>
<span class="token function">curl</span> <span class="token parameter variable">-L</span> https://raw.githubusercontent.com/docker/compose/1.29.1/contrib/completion/bash/docker-compose <span class="token operator">&gt;</span> /etc/bash_completion.d/docker-compose
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœè¿™é‡Œå‡ºç°é”™è¯¯ï¼Œéœ€è¦ä¿®æ”¹è‡ªå·±çš„ hosts æ–‡ä»¶ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;199.232.68.133 raw.githubusercontent.com&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h1 id="_3-docker-é•œåƒä»“åº“" tabindex="-1"><a class="header-anchor" href="#_3-docker-é•œåƒä»“åº“" aria-hidden="true">#</a> 3.Docker é•œåƒä»“åº“</h1><p>æ­å»ºé•œåƒä»“åº“å¯ä»¥åŸºäº Docker å®˜æ–¹æä¾›çš„ DockerRegistry æ¥å®ç°ã€‚</p><p>å®˜ç½‘åœ°å€ï¼šhttps://hub.docker.com/_/registry</p><h2 id="_3-1-ç®€åŒ–ç‰ˆé•œåƒä»“åº“" tabindex="-1"><a class="header-anchor" href="#_3-1-ç®€åŒ–ç‰ˆé•œåƒä»“åº“" aria-hidden="true">#</a> 3.1.ç®€åŒ–ç‰ˆé•œåƒä»“åº“</h2><p>Docker å®˜æ–¹çš„ Docker Registry æ˜¯ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬çš„ Docker é•œåƒä»“åº“ï¼Œå…·å¤‡ä»“åº“ç®¡ç†çš„å®Œæ•´åŠŸèƒ½ï¼Œä½†æ˜¯æ²¡æœ‰å›¾å½¢åŒ–ç•Œé¢ã€‚</p><p>æ­å»ºæ–¹å¼æ¯”è¾ƒç®€å•ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\\</span>
    <span class="token parameter variable">--restart</span><span class="token operator">=</span>always <span class="token punctuation">\\</span>
    <span class="token parameter variable">--name</span> registry	<span class="token punctuation">\\</span>
    <span class="token parameter variable">-p</span> <span class="token number">5000</span>:5000 <span class="token punctuation">\\</span>
    <span class="token parameter variable">-v</span> registry-data:/var/lib/registry <span class="token punctuation">\\</span>
    registry
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘½ä»¤ä¸­æŒ‚è½½äº†ä¸€ä¸ªæ•°æ®å· registry-data åˆ°å®¹å™¨å†…çš„/var/lib/registry ç›®å½•ï¼Œè¿™æ˜¯ç§æœ‰é•œåƒåº“å­˜æ”¾æ•°æ®çš„ç›®å½•ã€‚</p><p>è®¿é—® http://YourIp:5000/v2/_catalog å¯ä»¥æŸ¥çœ‹å½“å‰ç§æœ‰é•œåƒæœåŠ¡ä¸­åŒ…å«çš„é•œåƒ</p><h2 id="_3-2-å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#_3-2-å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬" aria-hidden="true">#</a> 3.2.å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬</h2><p>ä½¿ç”¨ DockerCompose éƒ¨ç½²å¸¦æœ‰å›¾è±¡ç•Œé¢çš„ DockerRegistryï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.0&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">registry</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> registry
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./registry<span class="token punctuation">-</span>data<span class="token punctuation">:</span>/var/lib/registry
  <span class="token key atrule">ui</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> joxit/docker<span class="token punctuation">-</span>registry<span class="token punctuation">-</span>ui<span class="token punctuation">:</span>static
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8080<span class="token punctuation">:</span><span class="token number">80</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> REGISTRY_TITLE=ä¼ æ™ºæ•™è‚²ç§æœ‰ä»“åº“
      <span class="token punctuation">-</span> REGISTRY_URL=http<span class="token punctuation">:</span>//registry<span class="token punctuation">:</span><span class="token number">5000</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> registry
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-3-é…ç½®-docker-ä¿¡ä»»åœ°å€" tabindex="-1"><a class="header-anchor" href="#_3-3-é…ç½®-docker-ä¿¡ä»»åœ°å€" aria-hidden="true">#</a> 3.3.é…ç½® Docker ä¿¡ä»»åœ°å€</h2><p>æˆ‘ä»¬çš„ç§æœé‡‡ç”¨çš„æ˜¯ http åè®®ï¼Œé»˜è®¤ä¸è¢« Docker ä¿¡ä»»ï¼Œæ‰€ä»¥éœ€è¦åšä¸€ä¸ªé…ç½®ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># æ‰“å¼€è¦ä¿®æ”¹çš„æ–‡ä»¶</span>
<span class="token function">vi</span> /etc/docker/daemon.json
<span class="token comment"># æ·»åŠ å†…å®¹ï¼š</span>
<span class="token string">&quot;insecure-registries&quot;</span>:<span class="token punctuation">[</span><span class="token string">&quot;http://192.168.150.101:8080&quot;</span><span class="token punctuation">]</span>
<span class="token comment"># é‡åŠ è½½</span>
systemctl daemon-reload
<span class="token comment"># é‡å¯docker</span>
systemctl restart <span class="token function">docker</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,57);function y(f,x){const a=c("router-link"),t=c("ExternalLinkIcon");return r(),o("div",null,[v,e("nav",k,[e("ul",null,[e("li",null,[s(a,{to:"#_1-1-å¸è½½-å¯é€‰"},{default:i(()=>[n("1.1.å¸è½½ï¼ˆå¯é€‰ï¼‰")]),_:1})]),e("li",null,[s(a,{to:"#_1-2-å®‰è£…-docker"},{default:i(()=>[n("1.2.å®‰è£… docker")]),_:1})]),e("li",null,[s(a,{to:"#_1-3-å¯åŠ¨-docker"},{default:i(()=>[n("1.3.å¯åŠ¨ docker")]),_:1})]),e("li",null,[s(a,{to:"#_1-4-é…ç½®é•œåƒåŠ é€Ÿ"},{default:i(()=>[n("1.4.é…ç½®é•œåƒåŠ é€Ÿ")]),_:1})]),e("li",null,[s(a,{to:"#_2-1-ä¸‹è½½"},{default:i(()=>[n("2.1.ä¸‹è½½")]),_:1})]),e("li",null,[s(a,{to:"#_2-2-ä¿®æ”¹æ–‡ä»¶æƒé™"},{default:i(()=>[n("2.2.ä¿®æ”¹æ–‡ä»¶æƒé™")]),_:1})]),e("li",null,[s(a,{to:"#_2-3-base-è‡ªåŠ¨è¡¥å…¨å‘½ä»¤"},{default:i(()=>[n("2.3.Base è‡ªåŠ¨è¡¥å…¨å‘½ä»¤ï¼š")]),_:1})]),e("li",null,[s(a,{to:"#_3-1-ç®€åŒ–ç‰ˆé•œåƒä»“åº“"},{default:i(()=>[n("3.1.ç®€åŒ–ç‰ˆé•œåƒä»“åº“")]),_:1})]),e("li",null,[s(a,{to:"#_3-2-å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬"},{default:i(()=>[n("3.2.å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬")]),_:1})]),e("li",null,[s(a,{to:"#_3-3-é…ç½®-docker-ä¿¡ä»»åœ°å€"},{default:i(()=>[n("3.3.é…ç½® Docker ä¿¡ä»»åœ°å€")]),_:1})])])]),b,h,e("p",null,[n("å®˜æ–¹ç½‘ç«™ä¸Šæœ‰å„ç§ç¯å¢ƒä¸‹çš„ "),e("a",g,[n("å®‰è£…æŒ‡å—"),s(t)]),n("ï¼Œè¿™é‡Œä¸»è¦ä»‹ç» Docker CE åœ¨ CentOS ä¸Šçš„å®‰è£…ã€‚")]),_])}const C=l(m,[["render",y],["__file","index.html.vue"]]);export{C as default};
